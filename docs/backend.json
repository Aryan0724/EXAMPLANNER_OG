{
  "entities": {
    "Student": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Student",
      "type": "object",
      "description": "Represents a student with their relevant information.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the student."
        },
        "studentId": {
          "type": "string",
          "description": "The student's ID number as given by their educational institution."
        },
        "name": {
          "type": "string",
          "description": "The full name of the student."
        },
        "department": {
          "type": "string",
          "description": "The department or faculty the student belongs to."
        },
        "email": {
          "type": "string",
          "description": "The student's email address.",
          "format": "email"
        },
        "isDebarred": {
          "type": "boolean",
          "description": "Indicates whether the student is debarred from taking exams."
        }
      },
      "required": [
        "id",
        "studentId",
        "name",
        "department",
        "email",
        "isDebarred"
      ]
    },
    "Classroom": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Classroom",
      "type": "object",
      "description": "Represents a classroom with its capacity and other relevant details.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the classroom."
        },
        "name": {
          "type": "string",
          "description": "The name or code of the classroom."
        },
        "capacity": {
          "type": "number",
          "description": "The maximum number of students the classroom can accommodate."
        },
        "location": {
          "type": "string",
          "description": "The location or building where the classroom is situated."
        }
      },
      "required": [
        "id",
        "name",
        "capacity",
        "location"
      ]
    },
    "Invigilator": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Invigilator",
      "type": "object",
      "description": "Represents an invigilator (exam supervisor) with their details and availability.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the invigilator."
        },
        "name": {
          "type": "string",
          "description": "The full name of the invigilator."
        },
        "email": {
          "type": "string",
          "description": "The invigilator's email address.",
          "format": "email"
        },
        "availability": {
          "type": "array",
          "description": "An array of date/time slots when the invigilator is available.",
          "items": {
            "type": "string"
          }
        }
      },
      "required": [
        "id",
        "name",
        "email",
        "availability"
      ]
    },
    "Exam": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Exam",
      "type": "object",
      "description": "Represents an exam event, including the subject, time, and assigned classroom.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the exam."
        },
        "subject": {
          "type": "string",
          "description": "The name of the subject for the exam."
        },
        "dateTime": {
          "type": "string",
          "description": "The date and time when the exam is scheduled.",
          "format": "date-time"
        },
        "classroomId": {
          "type": "string",
          "description": "Reference to Classroom. (Relationship: Classroom 1:N Exam)"
        },
        "invigilatorIds": {
          "type": "array",
          "description": "References to Invigilators. (Relationship: Invigilator N:N Exam)",
          "items": {
            "type": "string"
          }
        }
      },
      "required": [
        "id",
        "subject",
        "dateTime",
        "classroomId"
      ]
    },
    "SeatAssignment": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "SeatAssignment",
      "type": "object",
      "description": "Represents the assignment of a student to a specific seat in a classroom for an exam.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the seat assignment."
        },
        "examId": {
          "type": "string",
          "description": "Reference to Exam. (Relationship: Exam 1:N SeatAssignment)"
        },
        "studentId": {
          "type": "string",
          "description": "Reference to Student. (Relationship: Student 1:N SeatAssignment)"
        },
        "seatNumber": {
          "type": "number",
          "description": "The assigned seat number for the student in the classroom."
        }
      },
      "required": [
        "id",
        "examId",
        "studentId",
        "seatNumber"
      ]
    }
  },
  "auth": {
    "providers": [
      "password",
      "anonymous"
    ]
  },
  "firestore": {
    "structure": [
      {
        "path": "/students/{studentId}",
        "definition": {
          "entityName": "Student",
          "schema": {
            "$ref": "#/backend/entities/Student"
          },
          "description": "Stores student data. The studentId parameter is the unique identifier for each student.",
          "params": [
            {
              "name": "studentId",
              "description": "The unique identifier for the student."
            }
          ]
        }
      },
      {
        "path": "/classrooms/{classroomId}",
        "definition": {
          "entityName": "Classroom",
          "schema": {
            "$ref": "#/backend/entities/Classroom"
          },
          "description": "Stores classroom data. The classroomId parameter is the unique identifier for each classroom.",
          "params": [
            {
              "name": "classroomId",
              "description": "The unique identifier for the classroom."
            }
          ]
        }
      },
      {
        "path": "/invigilators/{invigilatorId}",
        "definition": {
          "entityName": "Invigilator",
          "schema": {
            "$ref": "#/backend/entities/Invigilator"
          },
          "description": "Stores invigilator data. The invigilatorId parameter is the unique identifier for each invigilator.",
          "params": [
            {
              "name": "invigilatorId",
              "description": "The unique identifier for the invigilator."
            }
          ]
        }
      },
      {
        "path": "/exams/{examId}",
        "definition": {
          "entityName": "Exam",
          "schema": {
            "$ref": "#/backend/entities/Exam"
          },
          "description": "Stores exam data. The examId parameter is the unique identifier for each exam.",
          "params": [
            {
              "name": "examId",
              "description": "The unique identifier for the exam."
            }
          ]
        }
      },
      {
        "path": "/seatAssignments/{seatAssignmentId}",
        "definition": {
          "entityName": "SeatAssignment",
          "schema": {
            "$ref": "#/backend/entities/SeatAssignment"
          },
          "description": "Stores seat assignment data. The seatAssignmentId parameter is the unique identifier for each seat assignment.",
          "params": [
            {
              "name": "seatAssignmentId",
              "description": "The unique identifier for the seat assignment."
            }
          ]
        }
      }
    ],
    "reasoning": "The Firestore structure is designed to manage student, classroom, invigilator, exam, and seat assignment data for the Examplanner application.  A flat collection structure is used to represent global data such as `classrooms` and `invigilators`. Student data is stored in a `students` collection. Exam data is kept in a `exams` collection. `seatAssignments` are stored in its own collection, enabling efficient queries for seating arrangements.\n\nAuthorization Independence (Denormalization):  Since authorization is based solely on user authentication (`request.auth.uid`) and potentially global roles (not specified but assumed needed for admin functions), denormalization focuses on making exam data accessible and manageable. No specific ownership is defined for Students, Classrooms, or Invigilators, so no denormalization of ownership is needed.  The seat assignments need to be queried and managed independently, the `seatAssignments` documents only contain references to other documents and no authorization-related data needs to be duplicated.\n\nQAPs Support (Segregation and Membership): This structure supports secure `list` operations by segregating data into collections based on entity type.  Global roles for admin functions (managing all exams, classrooms, etc.) can be implemented using an additional roles collection (e.g., `/roles_admin/{uid}`). Since seat assignments relate to exams, the seat assignments do not need any authorization context, therefore they are assigned to their own collection."
  }
}